\subsection{Cofinality}
\begin{definition}\label{def:cofinal} 
We say a subcategory $I \subseteq J$ is \textit{cofinal} if for any functor $F \colon J \to \mathscr{C}$, the induced map on colimits
\begin{equation}\label{eqn:cofinality}
\begin{aligned}
    \colim_I F \to \colim_J F
\end{aligned}
\end{equation}
is an isomorphism.\footnote{%
We dually say $I \subseteq J$ is \textit{final} if the natural map $\lim_I F \to \lim_J F$ is an isomorphism for any $F$.%
}
In other words, in order to compute a $J$-shaped colimit, it suffices to restrict to the subdiagram $I \subseteq J$.
\end{definition}

\begin{remark} This definition makes sense in 1-category theory as well as it does in $\infty$-category theory, however we remark that the two notions are different, so let's differentiate between the two, continuing the story of \autoref{def:cofinal}:
\begin{itemize}
    \item $I \subseteq J$ is $1$\textit{-cofinal} if for any $1$-category $\mathscr{C}$ and $1$-functor $F \colon J \to \mathscr{C}$, the induced map \autoref{eqn:cofinality} is an isomorphism.
    \item $I \subseteq J$ is \textit{cofinal} ($\infty$-cofinal if we want to be really pedantic) if for any $\infty$-category and $\infty$-functor $F \colon J \to \mathscr{C}$, the induced map \autoref{eqn:cofinality} is an equivalence.
\end{itemize}
Note this latter definition extends to the case where $I$ and $J$ are themselves $\infty$-categories, or even just simplicial sets.
\end{remark}

\begin{example}\label{exa:even-odd-cofinal}
The subcategories $2\mathbb{N} \subseteq \mathbb{N}$ and $2 \mathbb{N} + 1 \subseteq \mathbb{N}$ are both 1-cofinal and $\infty$-cofinal. 
\end{example}


It is straightforward to check when a subdiagram is 1-cofinal:
\begin{proposition} \cite[04E6]{Stacks}
$I \subseteq J$ is $1$-cofinal if
\begin{itemize}
    \item every $j\in J$ has some $i \in I$ with a morphism $j \to i$
    \item for every $j \in J$ and pair of objects $i,i'\in I$, there is a zig-zag of morphisms between $i,i'\in I$ and maps from $j$ into the zig-zag making the diagram commute:
\[ \begin{tikzcd}
     &  & j\dar\ar[dr]\ar[dl] &  & \\
    \cdots\rar & i_n & i_{n+1}\lar\rar & i_{n+2} & \lar\cdots \\
\end{tikzcd} \]
\end{itemize}
\end{proposition}

\begin{notation} Let $\DDelta^\inj \subseteq \DDelta$ be the subcategory of injective maps, and let $\DDelta_{\le n} \subseteq \DDelta$ denote the full subcategory of objects $[k]$ for $k\le n$. For example $\DDelta^\inj_{\le 1}$ is just a the category with two parallel arrows, i.e. the ``(co)equalizer'' category:
\begin{align*}
    \DDelta^\inj_{\le 1} := \bullet \rightrightarrows \bullet
\end{align*}
\end{notation}


\begin{example}\label{exa:1-cofinal-parallel-arrows-ddelta} 
We have that $\DDelta_{\le1}^{\inj,\,\op} \subseteq \DDelta^\op$ is 1-cofinal (c.f. \cite[8.3.8]{Riehl-categorical-htpy}).
\end{example}
% \begin{proof} It's easier to check the dual properties hold before taking the opposite category. It's clear both $[0]$ and $[1]$ map to any element in $\DDelta$. For the second condition we have to check the zig-zag condition. If $i=i'$ in this setting, then it is clear
% \end{proof}

\begin{proposition} The inclusion $\DDelta_{\le n}^{\inj,\op} \subseteq \DDelta^\op$ is $n$-cofinal for any $1\le n \le \infty$.
\end{proposition}


It turns out by a souped-up extension of Quillen Theorem A, originally due to Joyal, we have a necessary condition for cofinality in the $\infty$-categorical setting.

\begin{theorem} (Joyal, Quillen) Let $f \colon I \to J$ be a functor of 1-categories which is ($\infty$-)cofinal. Then the induced map on classifying spaces
\begin{align*}
    BI \to BJ
\end{align*}
is a weak homotopy equivalence \cite[4.1.3.1,~4.1.3.3]{HTT}.
\end{theorem}


\begin{example} The same subcategory $\DDelta_{\le1}^{\inj,\,\op} \subseteq \DDelta^\op$ is \textit{not} $\infty$-cofinal.
\end{example}
\begin{proof} The classifying space of the coequalizer diagram is $S^1$, however since $[0] \in\DDelta$ is terminal, it is initial in $\DDelta^\op$, hence $B\DDelta^\op \simeq \ast$ is contractible.
\end{proof}

\begin{remark} Removing this injectivity hypothesis is also interesting, since we include the opposite of the map $[1] \to [0]$ --- the category $\DDelta_{\le1}^\op$ is the \textit{split coequalizer} category:
\[\begin{tikzcd}[column sep=small]
    \bullet\rar[bend right=30]\rar[bend left=30] & \bullet\lar
\end{tikzcd} \]
\end{remark}

\begin{proposition} Each of the composites
\begin{align*}
    \DDelta_{\le1}^{\inj,\,\op} \subseteq \DDelta_{\le1}^\op \subseteq \DDelta^\op
\end{align*}
is $1$-cofinal, however none of these inclusions are $\infty$-cofinal.
\end{proposition}
\begin{proof} The universal property of the 1-categorical colimit for both $\DDelta_{\le1}^{\inj,\,\op}$ and $\DDelta_{\le1}^\op$ agree, so this is direct. The other inclusion now follows by \autoref{exa:1-cofinal-parallel-arrows-ddelta}.
\end{proof}

In general we cannot truncate in order to obtain an $\infty$-cofinal diagram. We can, however, restrict only to face maps and throw out degeneracies:

\begin{lemma} \cite[6.5.3.7]{HTT} The inclusion $\DDelta^{\inj,\op} \subseteq \DDelta$ is cofinal.
\end{lemma}



\begin{definition} An $\infty$-category $\mathscr{C}$ is \textit{sifted} if the diagonal map $\mathscr{C} \to \mathscr{C} \times \mathscr{C}$ is cofinal \cite[5.5.8.1]{HTT}.
\end{definition}

\begin{proposition}[{\cite[5.5.8.11]{HTT}}] \label{prop:sifted-colimits-finite-limits} 
  Sifted colimits valued in $\Set$ commute with finite products.
\end{proposition}

\begin{remark} In the 1-categorical setting, the converse of \autoref{prop:sifted-colimits-finite-limits} holds, meaning we can take this to be the definition of sifted colimits.
\end{remark}

\begin{example} $\ $
\begin{enumerate}
    \item The category $\DDelta^\op$ is sifted
    \item Any filtered category is sifted
\end{enumerate}
\end{example}

The examples above are the only interesting examples, in the following more precise sense.

\begin{proposition}\label{prop:sifted-is-filtered-plus-geometric-realizations} 
A category $\mathscr{C}$ admits all sifted colimits if and only if it admits all filtered colimits and it admits geometric realizations (meaning $\DDelta^\op$-indexed colimits).
\end{proposition}

\begin{corollary} A 1-category admits all sifted colimits if and only if it admits all filtered colimits and it has coequalizers.
\end{corollary}
\begin{proof} $\DDelta^\op$-indexed colimits are just coequalizers in 1-categories by \autoref{exa:1-cofinal-parallel-arrows-ddelta}.
\end{proof}

Moreover, we may add in \emph{finite coproducts} to capture all colimits.
\def\cC{\mathcal{C}}
\def\cD{\mathcal{D}}
\begin{proposition}\label{prop:colimit-is-sifted-plus-finite-coproducts}
  Let $\cC$ be a category, $\cD \subset \cC$, a full subcategory, and $X$ an object.
  Then, the following are equivalent.
  \begin{enumerate}[label={(\alph*)}]
    \item $X$ is a geometric realization of coproducts of elements in $\cD$.
    \item $X$ is a sifted colimit of finite coproducts of elements in $\cD$.
    \item $X$ is a colimit of object in $\cD$.
  \end{enumerate}
\end{proposition}
\begin{proof}
  The implication (a) $\implies$ (b) is essentially \autoref{prop:sifted-is-filtered-plus-geometric-realizations} (as coproducts are filtered colimits of finite coproducts) and the implication (b) $\implies$ (c) is the fact that colimits of colimits are colimits.
  The implication (c) $\implies$ (a) follows from the Bousfield-Kan formula for a limit of $p\colon K \rightarrow \cC$:
  \[
    \colim_K p \xleftarrow{\;\;\sim\;\;} \colim \left(
\begin{tikzcd}
	{\coprod\limits_{x \in K_0} p(x)} & {\coprod\limits_{\alpha \in K_1} p(\alpha(0))} & {\coprod\limits_{\alpha \in K_2} p(\alpha(0))} & \vdots
	\arrow[shift left, from=1-2, to=1-1]
	\arrow[shift right, from=1-2, to=1-1]
	\arrow[from=1-3, to=1-2]
	\arrow[shift right=2, from=1-3, to=1-2]
	\arrow[shift left=2, from=1-3, to=1-2]
	\arrow[shift left, from=1-4, to=1-3]
	\arrow[shift right, from=1-4, to=1-3]
	\arrow[shift left=3, from=1-4, to=1-3]
	\arrow[shift right=3, from=1-4, to=1-3]
\end{tikzcd}
    \right)
  \] 
  see e.g. \cite[Cor~12.5]{Shah-parametrized}.
\end{proof}
\subsection{Essential smallness}

Being small is not a property of categories that is invariant under equivalence, so it is more meaningful to ask whether a category is \textit{essentially small} (whether it is equivalent to a small category). This is equivalent to a category admitting a small skeleton, although the axiom of choice is required in order to pick representatives for each isomorphism class of object.

\begin{theorem}\label{thm:finite-type-schemes-essentially-small} 
The category of finite type $S$-schemes is essentially small.
\end{theorem}
\begin{proof}[Proof sketch] (see \href{https://mathoverflow.net/a/251044}{MO251044} for details) If $S = \Spec(A)$ is affine, then the category $\Alg_A^{\text{f.t.}}$ of finite type $A$-algebras is essentially small, since all the objects are isomorphic to algebras of the form $A[x_1, \ldots, x_n]/(f_1, \ldots, f_r)$, of which there are a set. We can glue finite type $S$-schemes over affines, and then bootstrap to the more general case of the base $S$ not being affine by gluing finite type schemes over all affine subschemes of $S$.
\end{proof}

\begin{remark} The category of all $S$-schemes is not essentially small.
\end{remark}

\section{Bonus: on localizing invariants}



\subsection{Idempotent-completion (for 1-categories)}

Suppose we are given a strict retract diagram
\[ \begin{tikzcd}
    Y\rar["i" above]\ar[dr,"\id" below left] & X\dar["r" right]\\
     & Y.
\end{tikzcd} \]
Then we have that $f := i\circ r \colon X \to X$ is an idempotent endomorphism of $X$, since $f\circ f = f$. This establishes a correspondence between isomorphism classes of retractive $X$-objects and idempotent endomorphisms of $X$:
\begin{equation}\label{eqn:retractive-objects-to-idempotents}
\begin{aligned}
    \ob \left(\mathscr{C}_{X // X}\right)^{\simeq} &\to \left\{ f\in \End_\mathscr{C}(X) \colon f^2 = f \right\} \\
    (Y,i,r) &\mapsto \left[X \xto{i\circ r} X\right].
\end{aligned}
\end{equation}
%
\begin{proposition} The map in \autoref{eqn:retractive-objects-to-idempotents} is always injective.
\end{proposition}
\begin{proof} Suppose we have another idempotent
\[ \begin{tikzcd}
    Z\rar["\iota" above]\ar[dr,"\id" below left] & X\dar["\rho" right]\\
     & Z,
\end{tikzcd} \]
so that $\iota\rho = ir$. Then we claim $Z$ and $Y$ are isomorphic as retractive $X$-objects. Indeed we see that
\begin{align*}
    Y \xto{i} X \xto{\rho} Z
\end{align*}
admits an inverse $Z\xto{\iota} X \xto{r} Y$, since $(\rho i)(r\iota) = \rho(ir)\iota = \rho\iota\rho\iota = \id$, and vice versa. In particular the diagram commutes
\[ \begin{tikzcd}
     & Z\dar["\iota"]\ar[dr,"\id" above right] & \\
     Y\rar["i" above]\ar[dr,"\id" below left]\ar[ur,"\rho\circ i" above left,"\sim" below right] & X\dar["r" right]\rar["\rho"] & Z\\
     & Y\ar[ur,"\rho\circ i" below right,"\sim" above left]\end{tikzcd} \]
Which exhibits $Y$ and $Z$ as isomorphic in the category $\mathscr{C}_{X//X}$ of retractive $X$-objects.
\end{proof}


\begin{proposition} If $\mathscr{C}$ admits equalizers, then $Y$ can be recovered from the associated idempotent as the equalizer:
\begin{align*}
    Y = \eq (\id, i\circ r \colon X \rightrightarrows X).
\end{align*}
\end{proposition}
\begin{proof} We claim this rectangle is a pullback:
\[ \begin{tikzcd}
    Y\dar["i" left]\ar[rr,"i" above] &  & X\dar["\id" right]\\
    X\rar["r" below] & Y\rar["i" below] & X\\
\end{tikzcd} \]
Indeed suppose $h \colon Z \to X$ satisfies $h = irh$. Then the diagram commutes:
\[ \begin{tikzcd}
Z\ar[ddr,"h" below left, bend right=5]\ar[drrr,"h" above right, bend left=5]\ar[dr,dashed,"hr" above right] & \\
    & Y\dar["i" left]\ar[rr,"i" above] &  & X\dar["\id" right]\\
    & X\rar["r" below] & Y\rar["i" below] & X.
\end{tikzcd} \]
\end{proof}

\begin{definition} We say that a 1-category $\mathscr{C}$ is \textit{idempotent complete} if for every object $X \in \mathscr{C}$, the correspondence between retractive objects and idempotent morphisms in \autoref{eqn:retractive-objects-to-idempotents} is a bijection.
\end{definition}

\begin{example} If $\mathscr{C}$ admits equalizers, it is idempotent complete.
\end{example}

\begin{proposition} Let $\mathscr{C} \subseteq \mathscr{D}$ be a full subcategory which is idempotent complete. Then it is closed under retracts in $\mathscr{D}$.
\end{proposition}
\begin{proof} Let $d \xto{i} c \xto{r} d$ be a retract of $c$ which lies in $\mathscr{D}$. Then $i\circ r \colon c \to c$ lies in $\mathscr{C}$ since it is a full subcategory, and since it is idempotent complete, we obtain that $(d,i,r) \in \mathscr{C}_{c // c}$, hence $d\in \mathscr{C}$.
\end{proof}

\begin{example} The category of free finitely generated $R$-modules is not idempotent complete.
\end{example}
\begin{proof} Let $P$ be a finitely generated projective $R$-module. Then it is a summand in a free $R$-module, i.e. $P \oplus Q \cong R^n$, and the combination of the inclusion and projection off the direct sum yields the identity:
\begin{align*}
    P \hookto R^n \to P.
\end{align*}
Hence $P$ is a retract of $R^n$. Considering the category of finitely generated free $R$-modules as a full subcategory of $\Mod_R$, we then observe it isn't closed under retracts, and hence isn't idempotent complete.
\end{proof}


\section{Idempotent completion, \texorpdfstring{$\infty$}{infty}-categorically}

The main distinction between idempotents in 1-categories versus $\infty$-categories is that being an idempotent in a 1-category is a \textit{property}, whereas in an $\infty$-category it is a \textit{structure} (witnessing idempotence requires additional data). This has various consequences, in particular that the admission of finite (co)limits is no longer sufficient to guarantee idempotent completeness.

\begin{example} \cite[4.4.5.1]{HTT} Let $C_\bullet(R)$ denote the category of bounded chain complexes of finitely generated free $R$-modules. Then $C_\bullet(R)$ is a stable $\infty$-category, but is only idempotent complete if every finitely generated projective $R$-module is stably free (if $K_0(R) = \Z$).
\end{example}

\begin{definition} \cite[4.4.5.3]{HTT} The simplicial set $\Idem$ is defined by the property that it has exactly one non-degenerate simplex in each dimension, and any face of any non-degenerate simplex is non-degenerate.
\end{definition}

So if $\Idem \to \mathscr{C}$ is a map of simplicial sets, it picks out a morphism $f$ in degree 1, and in degree 2 witnesses the composite
\[ \begin{tikzcd}
     & \bullet\ar[dr,"f" above right] & \\
    \bullet\ar[rr,"f" below]\ar[ur,"f" above left] &  & \bullet.
\end{tikzcd} \]
The higher data witnesses higher coherence. So we say an \textit{idempotent} in an $\infty$-category $\mathscr{C}$ is a map of simplicial sets $\Idem \to \mathscr{C}$ \cite[4.4.5.4]{HTT}.

\begin{definition} An $\infty$-category $\mathscr{C}$ is \textit{idempotent complete} if any idempotent $F \colon \Idem \to \mathscr{C}$ admits a colimit.
\end{definition}

Not every $\infty$-category is idempotent complete, but any category can be completed to one which is. This process is called \textit{idempotent completion} --- we say $f \colon \mathscr{C} \to \mathscr{D}$ is an \textit{idempotent completion} if (\cite[5.1.4.1]{HTT})
\begin{enumerate}
    \item $\mathscr{D}$ is idempotent complete
    \item $f$ is fully faithful
    \item every object in $\mathscr{D}$ is a retract of something in the image of $\mathscr{C}$.
\end{enumerate}

\begin{proposition} \cite[5.1.4.2,~5.4.2.4]{HTT} Every $\infty$-category admits an idempotent completion, given by
\begin{align*}
    \Idem(\mathscr{C}) := \Ind(\mathscr{C})^\omega.
\end{align*}
\end{proposition}
\begin{proof} Assume $\mathscr{C}$ is small without loss of generality (changing universes). Consider the Yoneda embedding $y \colon \mathscr{C} \to \Pre(\mathscr{C})$, and let $\mathscr{C}'$ denote the closure of $y(\mathscr{C})$ under retracts. More explicitly, if $\kappa$ is a regular cardinal, then we take $\Ind_\kappa(\mathscr{C})^\kappa$.
\end{proof}

Let $\Cat_\infty^\vee \subseteq \Cat_\infty$ be the full subcategory of idempotent-complete categories. Then this inclusion admits a left adjoint, given by idempotent completion \cite[5.4.2.18]{HTT}.

\begin{proposition} A small $\infty$-category is accessible if and only if it is idempotent complete \cite[5.4.3.?]{HTT}.
\end{proposition}

We denote by
\begin{align*}
    \Cat_\infty^\perf := \Cat_\infty^\st \cap \Cat_\infty^\vee,
\end{align*}
the category of idempotent complete stable $\infty$-categories (and exact functors). Then idempotent completion descends to an adjunction
\begin{align*}
    \Idem \colon \Cat_\infty^\st &\to \Cat_\infty^\perf.
\end{align*}


\subsection{Presentably symmetric monoidal categories}



\begin{definition} A \textit{presentably symmetric monoidal category} is any object in $\CAlg(\Pr^L, \otimes)$. This is the same as a symmetric monoidal $\infty$-category in which the tensor product
\begin{align*}
    \mathscr{C} \times \mathscr{C} \xto{\otimes} \mathscr{C}
\end{align*}
preserves colimits in each variable.
\end{definition}

\begin{proposition} % Freudenthal 2.2.2
If $\mathscr{C} \in \CAlg(\Pr^L)$ is presentably symmetric monoidal, and $S \subseteq \mathscr{C}$ is a set of objects, we can universally invert tensoring with each $x\in \mathscr{C}$, giving a new presentably symmetric monoidal category $\mathscr{C}[S^{-1}]$ with the obvious universal property. See Robalo 2.1
\end{proposition}

\begin{notation} We denote by $\Pr_\st^L \subseteq \Pr^L$ the full subcategory of stable categories.
\end{notation}

\begin{proposition} \textit{(Properties of $\Pr^L_\st$)}
\begin{enumerate}
    \item The category $\Pr^L_\st$ is symmetric monoidal, with unit $\Sp$ the category of spectra
    \item The Eilenberg--Watts theorem gives an equivalence
    \begin{align*}
        \Sp &\cong \Fun^L(\Sp,\Sp) \\
        X &\mapsto X \otimes-.
    \end{align*}
    \item If $\mathscr{C} \in \Pr^L_\st$ is dualizable, then its trace
    \begin{align*}
        \Sp \to \mathscr{C}^\vee \otimes \mathscr{C} \to \mathscr{C} \otimes \mathscr{C}^\vee \to \Sp
    \end{align*}
    is a spectrum (by Eilenberg--Watts), which is $\THH(\mathscr{C})$.
\end{enumerate}
\end{proposition}


\begin{notation} We denote by $\Cat^\perf \subseteq \Cat^\ex$ the full subcategory of idempotent-complete categories. This is part of an adjunction
\begin{align*}
    \Idem(-) \colon \Cat^\ex \leftrightarrows \Cat^\perf \colon \text{inclusion}.
\end{align*}
\end{notation}

Given a cardinal $\omega$, taking ind-completion or compact objects gives an equivalence
\begin{align*}
    \Ind \colon \Cat_\infty^\perf \overset{\sim}{\leftrightarrows} \mathrm{Pr}^L_{\st,\omega} \colon (-)^\omega
\end{align*}
In particular the unit $\id \to \Ind(-)^\omega$ is an equivalence because this is exactly idempotent completion. The counit being an equivalence is precisely that the category is accessible (generated by its compact objects under accessible colimits).


\begin{definition} An exact functor $F \colon \mathscr{C} \to \mathscr{D}$ of presentable stable categories is called \textit{strongly continuous} if either of the equivalent conditions hold:
\begin{enumerate}
    \item The right adjoint $F \dashv G$ is continuous
    \item The right adjoint to $F$ admits a further right adjoint.
\end{enumerate}
Denote by $\Fun^{LL}(\mathscr{C},\mathscr{D})$ the category of strongly continuous functors. We denote by $\Pr_\st^{LL} \subseteq \Pr_\st^L$ the subcategory on the same objects but with only strongly continuous morphisms.
\end{definition}





\begin{definition} We denote by $\Cat^\dual \subseteq \Pr^L_\st$ the (not full) subcategory of dualizable categories and strongly continuous functors. Or equivalently $\Cat_\dual \subseteq \Pr_\st^{LL}$ the full subcategory on dualizable categories.
\end{definition}

\begin{theorem} (Efimov) A presentable stable $\infty$-category is dualizable if and only if it is flat in $\Pr^L_\st$, meaning $\mathscr{C} \otimes -$ preserves fully faithful functors.
\end{theorem}


\begin{remark} By \cite[5.4.3.6]{HTT}, a small $\infty$-cat is accessible if and only if it is idempotent complete.\footnote{Idempotent complete has a number of definitions, in particular it implies that idempotent endomorphisms $f \colon X \to X$ (i.e. $f\circ f = f$) correspond bijectively to retracts of $X$, i.e. composites $Y \hookto X \to Y$. If $\mathscr{C}$ is idempotent complete then it is closed under retracts (\todo check this).} so finitely generated free $R$-modules fail to contain retracts (projectives) so they're not idempotent complete and hence not accessible.
\end{remark}

\subsection{Exact sequences in $\Cat_\infty^\perf$}

\begin{definition}\label{def:exact-sequence-PrLst}
\cite[5.8]{BGT} A sequence
\begin{align*}
    \mathcal{A} \to \mathcal{B} \to \mathcal{C}
\end{align*}
in $\Pr^L_\st$ is \textit{exact} if
\begin{enumerate}
    \item the composite is zero
    \item $\mathcal{A} \to \mathcal{B}$ is fully faithful
    \item the map $\mathcal{B}/\mathcal{A} \to \mathcal{C}$ is an equivalence.
\end{enumerate}
\end{definition}

\begin{definition}[{\cite[8.1]{BGT}}] A functor
\begin{align*}
    F \colon \Cat_\infty^\ex \to \mathscr{D},
\end{align*}
valued in any stable presentable $\infty$-category $\mathscr{D}$, is a \textit{localizing invariant} if it
\begin{itemize}
    \item inverts Morita equivalences,
    \item preserves filtered colimits,
    \item and sends exact sequences of small stable $\infty$-categories to cofiber sequences in $\mathscr{D}$.
\end{itemize}
\end{definition}



